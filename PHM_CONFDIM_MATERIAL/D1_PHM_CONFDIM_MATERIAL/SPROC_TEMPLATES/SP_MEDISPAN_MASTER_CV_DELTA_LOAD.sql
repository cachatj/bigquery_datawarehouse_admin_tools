
    CREATE PROCEDURE  `PROJECT_ID.D1_PHM_CONFDIM_MATERIAL.SP_MEDISPAN_MASTER_CV_DELTA_LOAD`()
    BEGIN
    /***********************************************************************************************************************

    Author: <Automatically Written Using Code Generator>
    Creation Date: <Insert Date>
    Sproc Purpose: Delta Loading Merge Sproc for MEDISPAN_MASTER_CV
    Data Sources:  See SQL Below

    ************************************************************************************************************************/
    DECLARE v_start_time timestamp;
    DECLARE v_start_stp timestamp;
    DECLARE v_end_stp timestamp;
    DECLARE v_stored_proc_name STRING;
    DECLARE last_load_timestamp timestamp;

    SET v_start_time = current_timestamp();
    SET v_start_stp = current_timestamp();
    SET v_end_stp = (SELECT CAST('9999-12-31 23:59:59' AS TIMESTAMP));
    SET v_stored_proc_name = 'D1_PHM_CONFDIM_MATERIAL.MEDISPAN_MASTER_CV_DELTA_LOAD';
    SET last_load_timestamp = (SELECT MAX(ROW_ADD_STP) FROM `PROJECT_ID.D1_PHM_CONFDIM_MATERIAL.MEDISPAN_MASTER_CV`);


    MERGE INTO  `PROJECT_ID.D1_PHM_CONFDIM_MATERIAL.MEDISPAN_MASTER_CV` AS target
     USING 
      (
     -- Developer's code goes here (SAMPLE CODE BELOW)

         --SELECT 
            a.column_1
            a.column_2
         --FROM 
         -- `PROJECT_ID.VI2_PHM_CONFFACT_BILLING.PHM_SDW__INVOICE_LINE_CV` il
         --JOIN
            --`PROJECT_ID.VI2_PHM_CONFDIM_TIME.PHM_SDW__TIME_DETAIL_CV` t
                --ON il.DTE_KEY_NUM = t.DTE_KEY_NUM
        --WHERE il.D0_UPDATE_STP > last_load_timestamp --- MOST IMPORTANT CONCEPT

      ) AS source
      ON TARGET.PRIMARY_KEY = SOURCE.PRIMARY_KEY
    WHEN MATCHED THEN
      UPDATE SET
        TARGET.NDC_UPC_HRI_ID = SOURCE.NDC_UPC_HRI_ID,
        TARGET.CHG_FLAG = SOURCE.CHG_FLAG,
        TARGET.SEQ_ID = SOURCE.SEQ_ID,
        TARGET.LABELE_CDE = SOURCE.LABELE_CDE,
        TARGET.GEN_TYPE_ID = SOURCE.GEN_TYPE_ID,
        TARGET.GEN_ID_NUM = SOURCE.GEN_ID_NUM,
        TARGET.DEA_CLASS_ID = SOURCE.DEA_CLASS_ID,
        TARGET.AHFS_THER_CLASS_CDE = SOURCE.AHFS_THER_CLASS_CDE,
        TARGET.ITEM_STAT_FLG = SOURCE.ITEM_STAT_FLG,
        TARGET.LOCAL_SYSTEM_FLG = SOURCE.LOCAL_SYSTEM_FLG,
        TARGET.TEE_ID = SOURCE.TEE_ID,
        TARGET.FMT_ID = SOURCE.FMT_ID,
        TARGET.RX_OTC_ID = SOURCE.RX_OTC_ID,
        TARGET.THIRD_PARTY_RSTRCT_ID = SOURCE.THIRD_PARTY_RSTRCT_ID,
        TARGET.MAINT_DRUG_ID = SOURCE.MAINT_DRUG_ID,
        TARGET.DSPNS_UNIT_ID = SOURCE.DSPNS_UNIT_ID,
        TARGET.UNIT_DOSE_PACK_ID = SOURCE.UNIT_DOSE_PACK_ID,
        TARGET.ROUTE_OF_ADMIN_ID = SOURCE.ROUTE_OF_ADMIN_ID,
        TARGET.FORM_TYPE_ID = SOURCE.FORM_TYPE_ID,
        TARGET.DLR_RANK_ID = SOURCE.DLR_RANK_ID,
        TARGET.RX_RANK_ID = SOURCE.RX_RANK_ID,
        TARGET.NUM_SYSTEM_CHAR_ID = SOURCE.NUM_SYSTEM_CHAR_ID,
        TARGET.SCNDRY_FMT_ID = SOURCE.SCNDRY_FMT_ID,
        TARGET.SCNDRY_ID = SOURCE.SCNDRY_ID,
        TARGET.MULTI_SRC_ID = SOURCE.MULTI_SRC_ID,
        TARGET.BRAND_NAM_ID = SOURCE.BRAND_NAM_ID,
        TARGET.INTRNL_EXTRNL_ID = SOURCE.INTRNL_EXTRNL_ID,
        TARGET.SINGLE_CMBNTN_ID = SOURCE.SINGLE_CMBNTN_ID,
        TARGET.STRG_CNDTN_ID = SOURCE.STRG_CNDTN_ID,
        TARGET.LMT_STBLTY_ID = SOURCE.LMT_STBLTY_ID,
        TARGET.OLD_NDC_UPC_HRI_ID = SOURCE.OLD_NDC_UPC_HRI_ID,
        TARGET.OLD_FMT_ID = SOURCE.OLD_FMT_ID,
        TARGET.OLD_EFFECT_DTE = SOURCE.OLD_EFFECT_DTE,
        TARGET.NEW_NDC_UPC_HRI_ID = SOURCE.NEW_NDC_UPC_HRI_ID,
        TARGET.NEW_FMT_ID = SOURCE.NEW_FMT_ID,
        TARGET.NEW_EFFECT_DTE = SOURCE.NEW_EFFECT_DTE,
        TARGET.PROD_NAM = SOURCE.PROD_NAM,
        TARGET.PROD_EXTN_NAM = SOURCE.PROD_EXTN_NAM,
        TARGET.ALRG_PTRN_CDE = SOURCE.ALRG_PTRN_CDE,
        TARGET.PPG_ID = SOURCE.PPG_ID,
        TARGET.HFPG_ID = SOURCE.HFPG_ID,
        TARGET.LABELE_TYPE_ID = SOURCE.LABELE_TYPE_ID,
        TARGET.PRICE_SPREAD_ID = SOURCE.PRICE_SPREAD_ID,
        TARGET.MFG_NAM = SOURCE.MFG_NAM,
        TARGET.MFG_ABBR_NAM = SOURCE.MFG_ABBR_NAM,
        TARGET.PROD_ABBR_DESC = SOURCE.PROD_ABBR_DESC,
        TARGET.DRUG_NAM_ID = SOURCE.DRUG_NAM_ID,
        TARGET.GEN_PROD_PACK_ID = SOURCE.GEN_PROD_PACK_ID,
        TARGET.GEN_PROD_ID = SOURCE.GEN_PROD_ID,
        TARGET.GPI_GEN_NAM = SOURCE.GPI_GEN_NAM,
        TARGET.GEN_PROD_PACK_SIZE_QTY = SOURCE.GEN_PROD_PACK_SIZE_QTY,
        TARGET.GEN_PROD_PACK_SIZE_UOM_ID = SOURCE.GEN_PROD_PACK_SIZE_UOM_ID,
        TARGET.GEN_PROD_PACK_QTY = SOURCE.GEN_PROD_PACK_QTY,
        TARGET.GEN_PROD_UNIT_DOSE_USE_PACK_ID = SOURCE.GEN_PROD_UNIT_DOSE_USE_PACK_ID,
        TARGET.GEN_PROD_PACK_DESC_ID = SOURCE.GEN_PROD_PACK_DESC_ID,
        TARGET.DOSAGE_FORM_ID = SOURCE.DOSAGE_FORM_ID,
        TARGET.PACK_SIZE_QTY = SOURCE.PACK_SIZE_QTY,
        TARGET.PACK_SIZE_UOM_ID = SOURCE.PACK_SIZE_UOM_ID,
        TARGET.PACK_QTY = SOURCE.PACK_QTY,
        TARGET.REPACK_ID = SOURCE.REPACK_ID,
        TARGET.TOTAL_PACK_QTY = SOURCE.TOTAL_PACK_QTY,
        TARGET.DESI_ID = SOURCE.DESI_ID,
        TARGET.PACK_DESC = SOURCE.PACK_DESC,
        TARGET.NEXT_SMALL_NDC_SUFFIX_ID = SOURCE.NEXT_SMALL_NDC_SUFFIX_ID,
        TARGET.NEXT_LARGE_NDC_SUFFIX_ID = SOURCE.NEXT_LARGE_NDC_SUFFIX_ID,
        TARGET.INNER_PACK_ID = SOURCE.INNER_PACK_ID,
        TARGET.CLINIC_PACK_ID = SOURCE.CLINIC_PACK_ID,
        TARGET.METRIC_STRGTH_ID = SOURCE.METRIC_STRGTH_ID,
        TARGET.STRGTH_UOM_ID = SOURCE.STRGTH_UOM_ID,
        TARGET.LMT_DIST_ID = SOURCE.LMT_DIST_ID,
        TARGET.EXT_AHFS_THER_CLASS_ID = SOURCE.EXT_AHFS_THER_CLASS_ID,
        TARGET.INACT_DTE = SOURCE.INACT_DTE,
        TARGET.CMS_FUL_PRICE_AMT = SOURCE.CMS_FUL_PRICE_AMT,
        TARGET.CMS_FUL_EFFECT_DTE = SOURCE.CMS_FUL_EFFECT_DTE,
        TARGET.FIRST_OLD_CMS_FUL_PRICE_AMT = SOURCE.FIRST_OLD_CMS_FUL_PRICE_AMT,
        TARGET.FIRST_OLD_CMS_FUL_EFFECT_DTE = SOURCE.FIRST_OLD_CMS_FUL_EFFECT_DTE,
        TARGET.SCND_OLD_CMS_FUL_LMT_PRICE_AMT = SOURCE.SCND_OLD_CMS_FUL_LMT_PRICE_AMT,
        TARGET.SCND_OLD_CMS_FUL_EFFECT_DTE = SOURCE.SCND_OLD_CMS_FUL_EFFECT_DTE,
        TARGET.WAC_PACK_PRICE_AMT = SOURCE.WAC_PACK_PRICE_AMT,
        TARGET.WAC_UNIT_PRICE_AMT = SOURCE.WAC_UNIT_PRICE_AMT,
        TARGET.WAC_EFFECT_DTE = SOURCE.WAC_EFFECT_DTE,
        TARGET.OLD_WAC_PACK_PRICE_AMT = SOURCE.OLD_WAC_PACK_PRICE_AMT,
        TARGET.OLD_WAC_UNIT_PRICE_AMT = SOURCE.OLD_WAC_UNIT_PRICE_AMT,
        TARGET.OLD_WAC_EFFECT_DTE = SOURCE.OLD_WAC_EFFECT_DTE,
        TARGET.AWP_ID = SOURCE.AWP_ID,
        TARGET.AWP_PACK_PRICE_AMT = SOURCE.AWP_PACK_PRICE_AMT,
        TARGET.AWP_UNIT_PRICE_AMT = SOURCE.AWP_UNIT_PRICE_AMT,
        TARGET.AWP_EFFECT_DTE = SOURCE.AWP_EFFECT_DTE,
        TARGET.OLD_AWP_PACK_PRICE_AMT = SOURCE.OLD_AWP_PACK_PRICE_AMT,
        TARGET.OLD_AWP_UNIT_PRICE_AMT = SOURCE.OLD_AWP_UNIT_PRICE_AMT,
        TARGET.OLD_AWP_EFFECT_DTE = SOURCE.OLD_AWP_EFFECT_DTE,
        TARGET.DP_PACK_PRICE_AMT = SOURCE.DP_PACK_PRICE_AMT,
        TARGET.DP_UNIT_PRICE_AMT = SOURCE.DP_UNIT_PRICE_AMT,
        TARGET.DP_EFFECT_DTE = SOURCE.DP_EFFECT_DTE,
        TARGET.OLD_DP_PACK_PRICE_AMT = SOURCE.OLD_DP_PACK_PRICE_AMT,
        TARGET.OLD_DP_UNIT_PRICE_AMT = SOURCE.OLD_DP_UNIT_PRICE_AMT,
        TARGET.OLD_DP_EFFECT_DTE = SOURCE.OLD_DP_EFFECT_DTE,
        TARGET.GPPC_UNIT_PRICE_AMT = SOURCE.GPPC_UNIT_PRICE_AMT,
        TARGET.GPPC_EFFECT_DTE = SOURCE.GPPC_EFFECT_DTE,
        TARGET.DRUG_GROUP_CDE = SOURCE.DRUG_GROUP_CDE,
        TARGET.DRUG_GROUP_DESCRIPTION = SOURCE.DRUG_GROUP_DESCRIPTION,
        TARGET.DRUG_CLASS_CDE = SOURCE.DRUG_CLASS_CDE,
        TARGET.DRUG_CLASS_DESCRIPTION = SOURCE.DRUG_CLASS_DESCRIPTION,
        TARGET.DRUG_SUB_CLASS_CDE = SOURCE.DRUG_SUB_CLASS_CDE,
        TARGET.DRUG_SUB_CLASS_DESCRIPTION = SOURCE.DRUG_SUB_CLASS_DESCRIPTION,
        TARGET.DRUG_CDE = SOURCE.DRUG_CDE,
        TARGET.DRUG_DESCRIPTION = SOURCE.DRUG_DESCRIPTION,
        TARGET.DEA_CLASS_DESCRIPTION = SOURCE.DEA_CLASS_DESCRIPTION,
        TARGET.TEE_DESCRIPTION = SOURCE.TEE_DESCRIPTION,
        TARGET.RX_OTC_DESCRIPTION = SOURCE.RX_OTC_DESCRIPTION,
        TARGET.THIRD_PARTY_ID_DESCRIPTION = SOURCE.THIRD_PARTY_ID_DESCRIPTION,
        TARGET.UNIT_DOSE_PACK_ID_DESCRIPTION = SOURCE.UNIT_DOSE_PACK_ID_DESCRIPTION,
        TARGET.ROUTE_OF_ADMIN_ID_DESCRIPTION = SOURCE.ROUTE_OF_ADMIN_ID_DESCRIPTION,
        TARGET.MULTI_SOURCE_ID_DESCRIPTION = SOURCE.MULTI_SOURCE_ID_DESCRIPTION,
        TARGET.BRAND_NAME_ID_DESCRIPTION = SOURCE.BRAND_NAME_ID_DESCRIPTION,
        TARGET.DOSAGE_FORM_ID_DESCRIPTION = SOURCE.DOSAGE_FORM_ID_DESCRIPTION,
        TARGET.PACK_SIZE_UOM_ID_DESCRIPTION = SOURCE.PACK_SIZE_UOM_ID_DESCRIPTION,
        TARGET.DESI_ID_DESCRIPTION = SOURCE.DESI_ID_DESCRIPTION,
        TARGET.ROW_ADD_STP = SOURCE.ROW_ADD_STP,
        TARGET.ROW_ADD_USER_ID = SOURCE.ROW_ADD_USER_ID,
        TARGET.ROW_UPDATE_STP = SOURCE.ROW_UPDATE_STP,
        TARGET.ROW_UPDATE_USER_ID = SOURCE.ROW_UPDATE_USER_ID
    WHEN NOT MATCHED THEN
      INSERT VALUES
      (
        SOURCE.NDC_UPC_HRI_ID,
        SOURCE.CHG_FLAG,
        SOURCE.SEQ_ID,
        SOURCE.LABELE_CDE,
        SOURCE.GEN_TYPE_ID,
        SOURCE.GEN_ID_NUM,
        SOURCE.DEA_CLASS_ID,
        SOURCE.AHFS_THER_CLASS_CDE,
        SOURCE.ITEM_STAT_FLG,
        SOURCE.LOCAL_SYSTEM_FLG,
        SOURCE.TEE_ID,
        SOURCE.FMT_ID,
        SOURCE.RX_OTC_ID,
        SOURCE.THIRD_PARTY_RSTRCT_ID,
        SOURCE.MAINT_DRUG_ID,
        SOURCE.DSPNS_UNIT_ID,
        SOURCE.UNIT_DOSE_PACK_ID,
        SOURCE.ROUTE_OF_ADMIN_ID,
        SOURCE.FORM_TYPE_ID,
        SOURCE.DLR_RANK_ID,
        SOURCE.RX_RANK_ID,
        SOURCE.NUM_SYSTEM_CHAR_ID,
        SOURCE.SCNDRY_FMT_ID,
        SOURCE.SCNDRY_ID,
        SOURCE.MULTI_SRC_ID,
        SOURCE.BRAND_NAM_ID,
        SOURCE.INTRNL_EXTRNL_ID,
        SOURCE.SINGLE_CMBNTN_ID,
        SOURCE.STRG_CNDTN_ID,
        SOURCE.LMT_STBLTY_ID,
        SOURCE.OLD_NDC_UPC_HRI_ID,
        SOURCE.OLD_FMT_ID,
        SOURCE.OLD_EFFECT_DTE,
        SOURCE.NEW_NDC_UPC_HRI_ID,
        SOURCE.NEW_FMT_ID,
        SOURCE.NEW_EFFECT_DTE,
        SOURCE.PROD_NAM,
        SOURCE.PROD_EXTN_NAM,
        SOURCE.ALRG_PTRN_CDE,
        SOURCE.PPG_ID,
        SOURCE.HFPG_ID,
        SOURCE.LABELE_TYPE_ID,
        SOURCE.PRICE_SPREAD_ID,
        SOURCE.MFG_NAM,
        SOURCE.MFG_ABBR_NAM,
        SOURCE.PROD_ABBR_DESC,
        SOURCE.DRUG_NAM_ID,
        SOURCE.GEN_PROD_PACK_ID,
        SOURCE.GEN_PROD_ID,
        SOURCE.GPI_GEN_NAM,
        SOURCE.GEN_PROD_PACK_SIZE_QTY,
        SOURCE.GEN_PROD_PACK_SIZE_UOM_ID,
        SOURCE.GEN_PROD_PACK_QTY,
        SOURCE.GEN_PROD_UNIT_DOSE_USE_PACK_ID,
        SOURCE.GEN_PROD_PACK_DESC_ID,
        SOURCE.DOSAGE_FORM_ID,
        SOURCE.PACK_SIZE_QTY,
        SOURCE.PACK_SIZE_UOM_ID,
        SOURCE.PACK_QTY,
        SOURCE.REPACK_ID,
        SOURCE.TOTAL_PACK_QTY,
        SOURCE.DESI_ID,
        SOURCE.PACK_DESC,
        SOURCE.NEXT_SMALL_NDC_SUFFIX_ID,
        SOURCE.NEXT_LARGE_NDC_SUFFIX_ID,
        SOURCE.INNER_PACK_ID,
        SOURCE.CLINIC_PACK_ID,
        SOURCE.METRIC_STRGTH_ID,
        SOURCE.STRGTH_UOM_ID,
        SOURCE.LMT_DIST_ID,
        SOURCE.EXT_AHFS_THER_CLASS_ID,
        SOURCE.INACT_DTE,
        SOURCE.CMS_FUL_PRICE_AMT,
        SOURCE.CMS_FUL_EFFECT_DTE,
        SOURCE.FIRST_OLD_CMS_FUL_PRICE_AMT,
        SOURCE.FIRST_OLD_CMS_FUL_EFFECT_DTE,
        SOURCE.SCND_OLD_CMS_FUL_LMT_PRICE_AMT,
        SOURCE.SCND_OLD_CMS_FUL_EFFECT_DTE,
        SOURCE.WAC_PACK_PRICE_AMT,
        SOURCE.WAC_UNIT_PRICE_AMT,
        SOURCE.WAC_EFFECT_DTE,
        SOURCE.OLD_WAC_PACK_PRICE_AMT,
        SOURCE.OLD_WAC_UNIT_PRICE_AMT,
        SOURCE.OLD_WAC_EFFECT_DTE,
        SOURCE.AWP_ID,
        SOURCE.AWP_PACK_PRICE_AMT,
        SOURCE.AWP_UNIT_PRICE_AMT,
        SOURCE.AWP_EFFECT_DTE,
        SOURCE.OLD_AWP_PACK_PRICE_AMT,
        SOURCE.OLD_AWP_UNIT_PRICE_AMT,
        SOURCE.OLD_AWP_EFFECT_DTE,
        SOURCE.DP_PACK_PRICE_AMT,
        SOURCE.DP_UNIT_PRICE_AMT,
        SOURCE.DP_EFFECT_DTE,
        SOURCE.OLD_DP_PACK_PRICE_AMT,
        SOURCE.OLD_DP_UNIT_PRICE_AMT,
        SOURCE.OLD_DP_EFFECT_DTE,
        SOURCE.GPPC_UNIT_PRICE_AMT,
        SOURCE.GPPC_EFFECT_DTE,
        SOURCE.DRUG_GROUP_CDE,
        SOURCE.DRUG_GROUP_DESCRIPTION,
        SOURCE.DRUG_CLASS_CDE,
        SOURCE.DRUG_CLASS_DESCRIPTION,
        SOURCE.DRUG_SUB_CLASS_CDE,
        SOURCE.DRUG_SUB_CLASS_DESCRIPTION,
        SOURCE.DRUG_CDE,
        SOURCE.DRUG_DESCRIPTION,
        SOURCE.DEA_CLASS_DESCRIPTION,
        SOURCE.TEE_DESCRIPTION,
        SOURCE.RX_OTC_DESCRIPTION,
        SOURCE.THIRD_PARTY_ID_DESCRIPTION,
        SOURCE.UNIT_DOSE_PACK_ID_DESCRIPTION,
        SOURCE.ROUTE_OF_ADMIN_ID_DESCRIPTION,
        SOURCE.MULTI_SOURCE_ID_DESCRIPTION,
        SOURCE.BRAND_NAME_ID_DESCRIPTION,
        SOURCE.DOSAGE_FORM_ID_DESCRIPTION,
        SOURCE.PACK_SIZE_UOM_ID_DESCRIPTION,
        SOURCE.DESI_ID_DESCRIPTION,
        SOURCE.ROW_ADD_STP,
        SOURCE.ROW_ADD_USER_ID,
        SOURCE.ROW_UPDATE_STP,
        SOURCE.ROW_UPDATE_USER_ID
      );
    END;
