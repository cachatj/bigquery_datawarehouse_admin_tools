
    CREATE PROCEDURE  `PROJECT_ID.D1_PHM_CONFDIM_MATERIAL.SP_FDB_MASTER_CV_DELTA_LOAD`()
    BEGIN
    /***********************************************************************************************************************

    Author: <Automatically Written Using Code Generator>
    Creation Date: <Insert Date>
    Sproc Purpose: Delta Loading Merge Sproc for FDB_MASTER_CV
    Data Sources:  See SQL Below

    ************************************************************************************************************************/
    DECLARE v_start_time timestamp;
    DECLARE v_start_stp timestamp;
    DECLARE v_end_stp timestamp;
    DECLARE v_stored_proc_name STRING;
    DECLARE last_load_timestamp timestamp;

    SET v_start_time = current_timestamp();
    SET v_start_stp = current_timestamp();
    SET v_end_stp = (SELECT CAST('9999-12-31 23:59:59' AS TIMESTAMP));
    SET v_stored_proc_name = 'D1_PHM_CONFDIM_MATERIAL.FDB_MASTER_CV_DELTA_LOAD';
    SET last_load_timestamp = (SELECT MAX(ROW_ADD_STP) FROM `PROJECT_ID.D1_PHM_CONFDIM_MATERIAL.FDB_MASTER_CV`);


    MERGE INTO  `PROJECT_ID.D1_PHM_CONFDIM_MATERIAL.FDB_MASTER_CV` AS target
     USING 
      (
     -- Developer's code goes here (SAMPLE CODE BELOW)

         --SELECT 
            a.column_1
            a.column_2
         --FROM 
         -- `PROJECT_ID.VI2_PHM_CONFFACT_BILLING.PHM_SDW__INVOICE_LINE_CV` il
         --JOIN
            --`PROJECT_ID.VI2_PHM_CONFDIM_TIME.PHM_SDW__TIME_DETAIL_CV` t
                --ON il.DTE_KEY_NUM = t.DTE_KEY_NUM
        --WHERE il.D0_UPDATE_STP > last_load_timestamp --- MOST IMPORTANT CONCEPT

      ) AS source
      ON TARGET.PRIMARY_KEY = SOURCE.PRIMARY_KEY
    WHEN MATCHED THEN
      UPDATE SET
        TARGET.NDC = SOURCE.NDC,
        TARGET.LBLRID = SOURCE.LBLRID,
        TARGET.GCN_SEQNO = SOURCE.GCN_SEQNO,
        TARGET.PS = SOURCE.PS,
        TARGET.DF = SOURCE.DF,
        TARGET.AD = SOURCE.AD,
        TARGET.LN = SOURCE.LN,
        TARGET.BN = SOURCE.BN,
        TARGET.PNDC = SOURCE.PNDC,
        TARGET.REPNDC = SOURCE.REPNDC,
        TARGET.NDCFI = SOURCE.NDCFI,
        TARGET.DADDNC = SOURCE.DADDNC,
        TARGET.DUPDC = SOURCE.DUPDC,
        TARGET.DESI = SOURCE.DESI,
        TARGET.DESDTEC = SOURCE.DESDTEC,
        TARGET.DESI2 = SOURCE.DESI2,
        TARGET.DES2DTEC = SOURCE.DES2DTEC,
        TARGET.DEA = SOURCE.DEA,
        TARGET.CL = SOURCE.CL,
        TARGET.GPI = SOURCE.GPI,
        TARGET.HOSP = SOURCE.HOSP,
        TARGET.INNOV = SOURCE.INNOV,
        TARGET.IPI = SOURCE.IPI,
        TARGET.MINI = SOURCE.MINI,
        TARGET.MAINT = SOURCE.MAINT,
        TARGET.OBC = SOURCE.OBC,
        TARGET.OBSDTEC = SOURCE.OBSDTEC,
        TARGET.PPI = SOURCE.PPI,
        TARGET.STPK = SOURCE.STPK,
        TARGET.REPACK = SOURCE.REPACK,
        TARGET.TOP200 = SOURCE.TOP200,
        TARGET.UD = SOURCE.UD,
        TARGET.CSP = SOURCE.CSP,
        TARGET.NDL_GDGE = SOURCE.NDL_GDGE,
        TARGET.NDL_LNGTH = SOURCE.NDL_LNGTH,
        TARGET.SYR_CPCTY = SOURCE.SYR_CPCTY,
        TARGET.SHLF_PCK = SOURCE.SHLF_PCK,
        TARGET.SHIPPER = SOURCE.SHIPPER,
        TARGET.HCFA_FDA = SOURCE.HCFA_FDA,
        TARGET.HCFA_UNIT = SOURCE.HCFA_UNIT,
        TARGET.HCFA_PS = SOURCE.HCFA_PS,
        TARGET.HCFA_APPC = SOURCE.HCFA_APPC,
        TARGET.HCFA_MRKC = SOURCE.HCFA_MRKC,
        TARGET.HCFA_TRMC = SOURCE.HCFA_TRMC,
        TARGET.HCFA_TYP = SOURCE.HCFA_TYP,
        TARGET.HCFA_DESC1 = SOURCE.HCFA_DESC1,
        TARGET.HCFA_DESI1 = SOURCE.HCFA_DESI1,
        TARGET.UU = SOURCE.UU,
        TARGET.PD = SOURCE.PD,
        TARGET.LN25 = SOURCE.LN25,
        TARGET.LN25I = SOURCE.LN25I,
        TARGET.GPIDC = SOURCE.GPIDC,
        TARGET.BBDC = SOURCE.BBDC,
        TARGET.HOME = SOURCE.HOME,
        TARGET.INPCKI = SOURCE.INPCKI,
        TARGET.OUTPCKI = SOURCE.OUTPCKI,
        TARGET.OBC_EXP = SOURCE.OBC_EXP,
        TARGET.PS_EQUIV = SOURCE.PS_EQUIV,
        TARGET.PLBLR = SOURCE.PLBLR,
        TARGET.TOP50GEN = SOURCE.TOP50GEN,
        TARGET.GMI = SOURCE.GMI,
        TARGET.GNI = SOURCE.GNI,
        TARGET.GSI = SOURCE.GSI,
        TARGET.GTI = SOURCE.GTI,
        TARGET.NDCGI1 = SOURCE.NDCGI1,
        TARGET.HCFA_DC = SOURCE.HCFA_DC,
        TARGET.LN60 = SOURCE.LN60,
        TARGET.HICL_SEQNO = SOURCE.HICL_SEQNO,
        TARGET.GCDF = SOURCE.GCDF,
        TARGET.GCRT = SOURCE.GCRT,
        TARGET.STR = SOURCE.STR,
        TARGET.GTC = SOURCE.GTC,
        TARGET.TC = SOURCE.TC,
        TARGET.DCC = SOURCE.DCC,
        TARGET.GCNSEQ_GI = SOURCE.GCNSEQ_GI,
        TARGET.GENDER = SOURCE.GENDER,
        TARGET.HIC3_SEQN = SOURCE.HIC3_SEQN,
        TARGET.STR60 = SOURCE.STR60,
        TARGET.RT = SOURCE.RT,
        TARGET.GCRT2 = SOURCE.GCRT2,
        TARGET.GCRT_DESC = SOURCE.GCRT_DESC,
        TARGET.SYSTEMIC = SOURCE.SYSTEMIC,
        TARGET.MFG = SOURCE.MFG,
        TARGET.LBLRIND = SOURCE.LBLRIND,
        TARGET.COLOR_TXT = SOURCE.COLOR_TXT,
        TARGET.SHAPE_TXT = SOURCE.SHAPE_TXT,
        TARGET.FLAVOR_TXT = SOURCE.FLAVOR_TXT,
        TARGET.CHG_FLAG = SOURCE.CHG_FLAG,
        TARGET.NDA_IND = SOURCE.NDA_IND,
        TARGET.ANDA_IND = SOURCE.ANDA_IND,
        TARGET.LISTING_SEQ_NO = SOURCE.LISTING_SEQ_NO,
        TARGET.TRADENAME = SOURCE.TRADENAME,
        TARGET.DOSE = SOURCE.DOSE,
        TARGET.GCDF_DESC = SOURCE.GCDF_DESC,
        TARGET.STRNUM = SOURCE.STRNUM,
        TARGET.VOLNUM = SOURCE.VOLNUM,
        TARGET.STRUN50 = SOURCE.STRUN50,
        TARGET.VOLUN50 = SOURCE.VOLUN50,
        TARGET.OBC_GCN = SOURCE.OBC_GCN,
        TARGET.GNN = SOURCE.GNN,
        TARGET.GNN60 = SOURCE.GNN60,
        TARGET.AHFS8 = SOURCE.AHFS8,
        TARGET.AHFS_DESC = SOURCE.AHFS_DESC,
        TARGET.GCN = SOURCE.GCN,
        TARGET.DCC_DESC = SOURCE.DCC_DESC,
        TARGET.GTC_DESC = SOURCE.GTC_DESC,
        TARGET.HIC3 = SOURCE.HIC3,
        TARGET.HIC3_DESC = SOURCE.HIC3_DESC,
        TARGET.HIC3_GRPN = SOURCE.HIC3_GRPN,
        TARGET.HIC3_ROOT = SOURCE.HIC3_ROOT,
        TARGET.OBC_SN = SOURCE.OBC_SN,
        TARGET.OBC_DESC = SOURCE.OBC_DESC,
        TARGET.MEDID = SOURCE.MEDID,
        TARGET.TM_SOURCE_ID = SOURCE.TM_SOURCE_ID,
        TARGET.TM_IND = SOURCE.TM_IND,
        TARGET.TM_ALT_MEDID_DESC = SOURCE.TM_ALT_MEDID_DESC,
        TARGET.TC_DESC = SOURCE.TC_DESC,
        TARGET.EFFECT_DTE = SOURCE.EFFECT_DTE,
        TARGET.AMP_PRICE = SOURCE.AMP_PRICE,
        TARGET.HCPC = SOURCE.HCPC,
        TARGET.HCPC_PBC1 = SOURCE.HCPC_PBC1,
        TARGET.HCPC_PBP1 = SOURCE.HCPC_PBP1,
        TARGET.HCPC_PBC2 = SOURCE.HCPC_PBC2,
        TARGET.HCPC_PBP2 = SOURCE.HCPC_PBP2,
        TARGET.HCPC_PBC3 = SOURCE.HCPC_PBC3,
        TARGET.HCPC_PBP3 = SOURCE.HCPC_PBP3,
        TARGET.HCPC_PBC4 = SOURCE.HCPC_PBC4,
        TARGET.HCPC_PBP4 = SOURCE.HCPC_PBP4,
        TARGET.HCPC_PBC5 = SOURCE.HCPC_PBC5,
        TARGET.HCPC_PBP5 = SOURCE.HCPC_PBP5,
        TARGET.HCPC_PBC6 = SOURCE.HCPC_PBC6,
        TARGET.HCPC_PBP6 = SOURCE.HCPC_PBP6,
        TARGET.HCPC_PBC7 = SOURCE.HCPC_PBC7,
        TARGET.HCPC_PBP7 = SOURCE.HCPC_PBP7,
        TARGET.HCPC_PBC8 = SOURCE.HCPC_PBC8,
        TARGET.HCPC_PBP8 = SOURCE.HCPC_PBP8,
        TARGET.MCR_BCDESC = SOURCE.MCR_BCDESC,
        TARGET.OBC3 = SOURCE.OBC3,
        TARGET.ROW_ADD_STP = SOURCE.ROW_ADD_STP,
        TARGET.ROW_ADD_USER_ID = SOURCE.ROW_ADD_USER_ID,
        TARGET.ROW_UPDATE_STP = SOURCE.ROW_UPDATE_STP,
        TARGET.ROW_UPDATE_USER_ID = SOURCE.ROW_UPDATE_USER_ID
    WHEN NOT MATCHED THEN
      INSERT VALUES
      (
        SOURCE.NDC,
        SOURCE.LBLRID,
        SOURCE.GCN_SEQNO,
        SOURCE.PS,
        SOURCE.DF,
        SOURCE.AD,
        SOURCE.LN,
        SOURCE.BN,
        SOURCE.PNDC,
        SOURCE.REPNDC,
        SOURCE.NDCFI,
        SOURCE.DADDNC,
        SOURCE.DUPDC,
        SOURCE.DESI,
        SOURCE.DESDTEC,
        SOURCE.DESI2,
        SOURCE.DES2DTEC,
        SOURCE.DEA,
        SOURCE.CL,
        SOURCE.GPI,
        SOURCE.HOSP,
        SOURCE.INNOV,
        SOURCE.IPI,
        SOURCE.MINI,
        SOURCE.MAINT,
        SOURCE.OBC,
        SOURCE.OBSDTEC,
        SOURCE.PPI,
        SOURCE.STPK,
        SOURCE.REPACK,
        SOURCE.TOP200,
        SOURCE.UD,
        SOURCE.CSP,
        SOURCE.NDL_GDGE,
        SOURCE.NDL_LNGTH,
        SOURCE.SYR_CPCTY,
        SOURCE.SHLF_PCK,
        SOURCE.SHIPPER,
        SOURCE.HCFA_FDA,
        SOURCE.HCFA_UNIT,
        SOURCE.HCFA_PS,
        SOURCE.HCFA_APPC,
        SOURCE.HCFA_MRKC,
        SOURCE.HCFA_TRMC,
        SOURCE.HCFA_TYP,
        SOURCE.HCFA_DESC1,
        SOURCE.HCFA_DESI1,
        SOURCE.UU,
        SOURCE.PD,
        SOURCE.LN25,
        SOURCE.LN25I,
        SOURCE.GPIDC,
        SOURCE.BBDC,
        SOURCE.HOME,
        SOURCE.INPCKI,
        SOURCE.OUTPCKI,
        SOURCE.OBC_EXP,
        SOURCE.PS_EQUIV,
        SOURCE.PLBLR,
        SOURCE.TOP50GEN,
        SOURCE.GMI,
        SOURCE.GNI,
        SOURCE.GSI,
        SOURCE.GTI,
        SOURCE.NDCGI1,
        SOURCE.HCFA_DC,
        SOURCE.LN60,
        SOURCE.HICL_SEQNO,
        SOURCE.GCDF,
        SOURCE.GCRT,
        SOURCE.STR,
        SOURCE.GTC,
        SOURCE.TC,
        SOURCE.DCC,
        SOURCE.GCNSEQ_GI,
        SOURCE.GENDER,
        SOURCE.HIC3_SEQN,
        SOURCE.STR60,
        SOURCE.RT,
        SOURCE.GCRT2,
        SOURCE.GCRT_DESC,
        SOURCE.SYSTEMIC,
        SOURCE.MFG,
        SOURCE.LBLRIND,
        SOURCE.COLOR_TXT,
        SOURCE.SHAPE_TXT,
        SOURCE.FLAVOR_TXT,
        SOURCE.CHG_FLAG,
        SOURCE.NDA_IND,
        SOURCE.ANDA_IND,
        SOURCE.LISTING_SEQ_NO,
        SOURCE.TRADENAME,
        SOURCE.DOSE,
        SOURCE.GCDF_DESC,
        SOURCE.STRNUM,
        SOURCE.VOLNUM,
        SOURCE.STRUN50,
        SOURCE.VOLUN50,
        SOURCE.OBC_GCN,
        SOURCE.GNN,
        SOURCE.GNN60,
        SOURCE.AHFS8,
        SOURCE.AHFS_DESC,
        SOURCE.GCN,
        SOURCE.DCC_DESC,
        SOURCE.GTC_DESC,
        SOURCE.HIC3,
        SOURCE.HIC3_DESC,
        SOURCE.HIC3_GRPN,
        SOURCE.HIC3_ROOT,
        SOURCE.OBC_SN,
        SOURCE.OBC_DESC,
        SOURCE.MEDID,
        SOURCE.TM_SOURCE_ID,
        SOURCE.TM_IND,
        SOURCE.TM_ALT_MEDID_DESC,
        SOURCE.TC_DESC,
        SOURCE.EFFECT_DTE,
        SOURCE.AMP_PRICE,
        SOURCE.HCPC,
        SOURCE.HCPC_PBC1,
        SOURCE.HCPC_PBP1,
        SOURCE.HCPC_PBC2,
        SOURCE.HCPC_PBP2,
        SOURCE.HCPC_PBC3,
        SOURCE.HCPC_PBP3,
        SOURCE.HCPC_PBC4,
        SOURCE.HCPC_PBP4,
        SOURCE.HCPC_PBC5,
        SOURCE.HCPC_PBP5,
        SOURCE.HCPC_PBC6,
        SOURCE.HCPC_PBP6,
        SOURCE.HCPC_PBC7,
        SOURCE.HCPC_PBP7,
        SOURCE.HCPC_PBC8,
        SOURCE.HCPC_PBP8,
        SOURCE.MCR_BCDESC,
        SOURCE.OBC3,
        SOURCE.ROW_ADD_STP,
        SOURCE.ROW_ADD_USER_ID,
        SOURCE.ROW_UPDATE_STP,
        SOURCE.ROW_UPDATE_USER_ID
      );
    END;
