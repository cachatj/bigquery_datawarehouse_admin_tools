CREATE VIEW `PROJECT_ID.VW_PHM_CONFDIM_CUSTOMER.CUSTOMER_CV`(
  CUSTOMER_NUM OPTIONS(description="Customer Number,"),
  VRSN_START_DTE OPTIONS(description="Derived by data engineering,"),
  VRSN_END_DTE OPTIONS(description="Derived by data engineering,"),
  CURR_VRSN_FLG OPTIONS(description="Derived by data engineering,"),
  CUSTOMER_NAM OPTIONS(description="Customer Name,"),
  CUSTOMER_LIC_NAM OPTIONS(description="Customer License Name,"),
  CUSTOMER_DBA_NAM OPTIONS(description="Customer DBA Name,"),
  CUSTOMER_PREFER_NAM OPTIONS(description="Customer Preferred Name,"),
  ADDR_TXT OPTIONS(description="Address Text,"),
  CITY OPTIONS(description="City,"),
  ZIP OPTIONS(description="Zip,"),
  STATE OPTIONS(description="State,"),
  CNTRY_CDE OPTIONS(description="Country Code,"),
  CNTY OPTIONS(description="County,"),
  PO_BOX OPTIONS(description="PO Box,"),
  PO_BOX_ZIP OPTIONS(description="PO Box Zip,"),
  TIM_ZONE OPTIONS(description="Time Zone,"),
  PHONE_NUM OPTIONS(description="Telephone Number,"),
  FAX_NUM OPTIONS(description="Fax Number,"),
  DEL_IND_FLG OPTIONS(description="Deletion Indicator Flag,"),
  SORT_FIELD_TXT OPTIONS(description="Sort Field Text,"),
  CENT_ORDER_BLCK_ID OPTIONS(description="Central Order Block ID,"),
  CENT_ORDER_BLCK_DESC_TXT OPTIONS(description="Central Order Block Description Text"),
  INTRNTL_LOCATION_PART_1_NUM OPTIONS(description="International Location Part 1 Number,"),
  INTRNTL_LOCATION_PART_2_NUM OPTIONS(description="International Location Part 2 Number,"),
  INDST_KEY_ID OPTIONS(description="Industry key  ID,"),
  INDST_KEY_DESC_TXT OPTIONS(description="Industry key Description Text"),
  CALC_340B_CUSTOMER_FLG OPTIONS(description="Calculated 340B Customer Flag"),
  CALC_GPO_CUSTOMER_FLG OPTIONS(description="Calculated GPO Customer Flag"),
  INTRNTL_LOCATION_CHECKDIGIT_NUM OPTIONS(description="International Location Checkdigit Number,"),
  CREATE_ON_DTE OPTIONS(description="Created On Date"),
  CREATE_BY_USER_ID OPTIONS(description="Created By User ID,"),
  CENT_BILL_BLCK_ID OPTIONS(description="Central Billing Block  ID,"),
  CENT_BILL_BLCK_DESC_TXT OPTIONS(description="Central Billing Block Description Text"),
  CUSTOMER_ACCT_GROUP_ID OPTIONS(description="Customer Account Group  ID,"),
  CUSTOMER_ACCT_GROUP_DESC_TXT OPTIONS(description="Customer Account Group Description Text"),
  CUSTOMER_CLASS_OF_TRADE_ID OPTIONS(description="Customer Class Of Trade  ID,"),
  CUSTOMER_CLASS_OF_TRADE_DESC_TXT OPTIONS(description="Customer Class Of Trade Description Text"),
  CENT_DLVRY_BLCK_ID OPTIONS(description="Central Delivery Block  ID,"),
  CENT_DLVRY_BLCK_DESC_TXT OPTIONS(description="Central Delivery Block Description Text"),
  CENT_PSTNG_BLCK_FLG OPTIONS(description="Central Posting Block Flag"),
  TRNSPT_ZONE_ID OPTIONS(description="Transportation Zone ID,"),
  TRADE_PRTNR_CMPNY_ID OPTIONS(description="Trading Partner Company  ID,"),
  TRADE_PRTNR_CMPNY_NAM OPTIONS(description="Trading Partner Company Name"),
  LGL_STAT_ID OPTIONS(description="Legal status  ID,"),
  LGL_STAT_DESC_TXT OPTIONS(description="Legal status Description Text"),
  EZ_CART_DLVRY_PROG_FLG OPTIONS(description="EZ Cart Delivery Program Flag"),
  DOUBLE_QC_FLG OPTIONS(description="Double QC Flag"),
  OE_REPLICATE_PRICE_CTLG_FLG OPTIONS(description="OE replicate price catalog flag"),
  ERECEIVER_CUSTOMER_FLG OPTIONS(description="eReceiver Customer Flag"),
  SPD_MTRL_SPECIAL_PYMT_TERMS_EXCLN_FLG OPTIONS(description="SPD Material Special Payment Terms Exclusion Flag"),
  BKORDR_RESTRICTION_ID OPTIONS(description="Backorder Restriction  ID,"),
  BKORDR_RESTRICTION_DESC_TXT OPTIONS(description="Backorder Restriction Description Text"),
  OTC_RESTRICTION_ID OPTIONS(description="OTC Restriction  ID,"),
  OTC_RESTRICTION_DESC_TXT OPTIONS(description="OTC Restriction Description Text"),
  C2_RESTRICTION_ID OPTIONS(description="C2 Restriction  ID,"),
  C2_RESTRICTION_DESC_TXT OPTIONS(description="C2 Restriction Description Text"),
  CALC_DEA_LIC_VALID_TO_DTE OPTIONS(description="Calculated DEA License Valid To Date"),
  CALC_PHYSCN_STATE_LIC_ID OPTIONS(description="Calculated Physician State License ID"),
  CALC_PHYSCN_STATE_LIC_VALID_TO_DTE OPTIONS(description="Calculated Physician State License Valid To Date"),
  CALC_PHYSCN_DME_LIC_ID OPTIONS(description="Calculated Physician DME License ID"),
  CALC_PHYSCN_DME_LIC_VALID_TO_DTE OPTIONS(description="Calculated Physician DME License Valid To Date"),
  CALC_EXGEN_ST_PRIS_EMBK OPTIONS(description="Calculated State Prescription License Number;GEART_EMBK ='RX' AND GENST_EMBK ='C' AND datenow >= CALC_GANDA_ST_PRIS_LIC_EMBK AND CURRENT_DATE between EMBK.GANDA and EMBK.GENDA"),
  CALC_GENDA_ST_PRIS_LIC_EMBK OPTIONS(description="State Prescription License Validity End Date;Convert EMBK.GENDA to ISO format, default for invalid date = 1900-01-01"),
  CALC_EXGEN_ST_LIC_EMBK OPTIONS(description="Calculated State License Number;GEART_EMBK ='RX' AND GENST_EMBK ='C' AND datenow >= CALC_GANDA_ST_LIC_EMBK AND CURRENT_DATE between EMBK.GANDA and EMBK.GENDA"),
  CALC_GENDA_ST_LIC_EMBK OPTIONS(description="State License Validity End Date;Convert EMBK.GENDA to ISO format, default for invalid date = 1900-01-01"),
  TAX_JRSDCTN_ID OPTIONS(description="Tax Jurisdiction ID,"),
  NON_MLTRY_USE_FLG OPTIONS(description="Non Military Use Flag"),
  CUSTOMER_PRIM_BU_ID OPTIONS(description="Customer Primary BU  ID,"),
  CUSTOMER_PRIM_BU_DESC_TXT OPTIONS(description="Customer Primary BU Description Text"),
  MKT_RLT_EFFECT_DTE OPTIONS(description="Marketing Relationship Effective Date"),
  MKT_RLT_END_DTE OPTIONS(description="Marketing Relationship End Date"),
  OPIOID_EXEMPT_FLG OPTIONS(description="Opioid Exempt Flag"),
  MON_FREE_SHIP_DAY_FLG OPTIONS(description="Monday Free Shipping Day Flag"),
  TUE_FREE_SHIP_DAY_FLG OPTIONS(description="Tuesday Free Shipping Day Flag"),
  WED_FREE_SHIP_DAY_FLG OPTIONS(description="Wednesday Free Shipping Day Flag"),
  THU_FREE_SHIP_DAY_FLG OPTIONS(description="Thursday Free Shipping Day Flag"),
  FRI_FREE_SHIP_DAY_FLG OPTIONS(description="Friday Free Shipping Day Flag"),
  SAT_FREE_SHIP_DAY_FLG OPTIONS(description="Saturday Free Shipping Day Flag"),
  SUN_FREE_SHIP_DAY_FLG OPTIONS(description="Sunday Free Shipping Day Flag"),
  TAX_CTGRY_ID OPTIONS(description="Tax Category ID"),
  TAX_CLASS_ID OPTIONS(description="Tax Classification  ID"),
  TAX_CLASS_DESC_TXT OPTIONS(description="Tax Classification Description Text"),
  ADDR_RFRNC_NUM_ID OPTIONS(description="Address Reference Number ID,"),
  BUILD_ID OPTIONS(description="Building ID"),
  ROW_ADD_STP OPTIONS(description="Indicates date the row was inserted"),
  ROW_ADD_USER_ID OPTIONS(description="Indicates by which job the row was inserted"),
  ROW_UPDATE_STP OPTIONS(description="Indicates date the row was updated"),
  ROW_UPDATE_USER_ID OPTIONS(description="Indicates by which job the row was updated")
)
AS SELECT
	KUNNR_KNA1 AS CUSTOMER_NUM,
	VRSN_START_DTE AS VRSN_START_DTE,
	VRSN_END_DTE AS VRSN_END_DTE,
	CURR_VRSN_FLG AS CURR_VRSN_FLG,
	NAME1_KNA1 AS CUSTOMER_NAM,
	NAME2_KNA1 AS CUSTOMER_LIC_NAM,
	NAME3_KNA1 AS CUSTOMER_DBA_NAM,
	NAME4_KNA1 AS CUSTOMER_PREFER_NAM,
	STRAS_KNA1 AS ADDR_TXT,
	ORT01_KNA1 AS CITY,
	PSTLZ_KNA1 AS ZIP,
	REGIO_KNA1 AS STATE,
	LAND1_KNA1 AS CNTRY_CDE,
	ORT02_KNA1 AS CNTY,
	PFACH_KNA1 AS PO_BOX,
	PSTL2_KNA1 AS PO_BOX_ZIP,
	TIME_ZONE_ADRC AS TIM_ZONE,
	TELF1_KNA1 AS PHONE_NUM,
	TELFX_KNA1 AS FAX_NUM,
	LOEVM_KNA1 AS DEL_IND_FLG,
	SORTL_KNA1 AS SORT_FIELD_TXT,
	AUFSD_KNA1 AS CENT_ORDER_BLCK_ID,
	VTEXT_TVAST_CENTRAL_ORDER_BLOCK AS CENT_ORDER_BLCK_DESC_TXT,
	BBBNR_KNA1 AS INTRNTL_LOCATION_PART_1_NUM,
	BBSNR_KNA1 AS INTRNTL_LOCATION_PART_2_NUM,
	BRSCH_KNA1 AS INDST_KEY_ID,
	BRTXT_T016T_INDUSTRY_KEY AS INDST_KEY_DESC_TXT,
	CALC_340B_CUSTOMER_FLG AS CALC_340B_CUSTOMER_FLG,
	CALC_GPO_CUSTOMER_FLG AS CALC_GPO_CUSTOMER_FLG,
	BUBKZ_KNA1 AS INTRNTL_LOCATION_CHECKDIGIT_NUM,
	ERDAT_KNA1 AS CREATE_ON_DTE,
	ERNAM_KNA1 AS CREATE_BY_USER_ID,
	FAKSD_KNA1 AS CENT_BILL_BLCK_ID,
	VTEXT_TVFST_CENTRAL_BILLING_BLOCK AS CENT_BILL_BLCK_DESC_TXT,
	KTOKD_KNA1 AS CUSTOMER_ACCT_GROUP_ID,
	TXT30_T077X_CUSTOMER_ACCOUNT_GROUP AS CUSTOMER_ACCT_GROUP_DESC_TXT,
	KUKLA_KNA1 AS CUSTOMER_CLASS_OF_TRADE_ID,
	VTEXT_TKUKT_CUSTOMER_CLASS_OF_TRADE AS CUSTOMER_CLASS_OF_TRADE_DESC_TXT,
	LIFSD_KNA1 AS CENT_DLVRY_BLCK_ID,
	VTEXT_TVLST_CENTRAL_DELIVERY_BLOCK AS CENT_DLVRY_BLCK_DESC_TXT,
	SPERR_KNA1 AS CENT_PSTNG_BLCK_FLG,
	LZONE_KNA1 AS TRNSPT_ZONE_ID,
	VBUND_KNA1 AS TRADE_PRTNR_CMPNY_ID,
	NAME1_T880_TRADING_PARTNER_COMPANY AS TRADE_PRTNR_CMPNY_NAM,
	GFORM_KNA1 AS LGL_STAT_ID,
	VTEXT_TVGFT_LEGAL_STATUS AS LGL_STAT_DESC_TXT,
	KATR1_KNA1 AS EZ_CART_DLVRY_PROG_FLG,
	KATR2_KNA1 AS DOUBLE_QC_FLG,
	KATR3_KNA1 AS OE_REPLICATE_PRICE_CTLG_FLG,
	KATR4_KNA1 AS ERECEIVER_CUSTOMER_FLG,
	KATR5_KNA1 AS SPD_MTRL_SPECIAL_PYMT_TERMS_EXCLN_FLG,
	KATR6_KNA1 AS BKORDR_RESTRICTION_ID,
	VTEXT_TVK6T_BACKORDER_RESTRICTION AS BKORDR_RESTRICTION_DESC_TXT,
	KATR7_KNA1 AS OTC_RESTRICTION_ID,
	VTEXT_TVK7T_OTC_RESTRICTION AS OTC_RESTRICTION_DESC_TXT,
	KATR8_KNA1 AS C2_RESTRICTION_ID,
	VTEXT_TVK8T_C2_RESTRICTION AS C2_RESTRICTION_DESC_TXT,
  	GENDA_EMBK AS CALC_DEA_LIC_VALID_TO_DTE,
	CALC_PHYSCN_STATE_LIC_ID AS CALC_PHYSCN_STATE_LIC_ID,
	CALC_PHYSCN_STATE_LIC_VALID_TO_DTE AS CALC_PHYSCN_STATE_LIC_VALID_TO_DTE,
	CALC_PHYSCN_DME_LIC_ID AS CALC_PHYSCN_DME_LIC_ID,
	CALC_PHYSCN_DME_LIC_VALID_TO_DTE AS CALC_PHYSCN_DME_LIC_VALID_TO_DTE,
	CALC_EXGEN_ST_PRIS_EMBK AS CALC_EXGEN_ST_PRIS_EMBK,
	CALC_GENDA_ST_PRIS_LIC_EMBK AS CALC_GENDA_ST_PRIS_LIC_EMBK,
	CALC_EXGEN_ST_LIC_EMBK AS CALC_EXGEN_ST_LIC_EMBK,
	CALC_GENDA_ST_LIC_EMBK AS CALC_GENDA_ST_LIC_EMBK,
	TXJCD_KNA1 AS TAX_JRSDCTN_ID,
	CIVVE_KNA1 AS NON_MLTRY_USE_FLG,
	YYPRIME_KNA1 AS CUSTOMER_PRIM_BU_ID,
	DESCR_YTSD_PRIMARY_BU_PRIMARY_BUSINESS_UNIT AS CUSTOMER_PRIM_BU_DESC_TXT,
	YYPGSTART_KNA1 AS MKT_RLT_EFFECT_DTE,
	YYPGEND_KNA1 AS MKT_RLT_END_DTE,
	YYOPDXMPT_KNA1 AS OPIOID_EXEMPT_FLG,
	YYFRTMON_KNA1 AS MON_FREE_SHIP_DAY_FLG,
	YYFRTTUE_KNA1 AS TUE_FREE_SHIP_DAY_FLG,
	YYFRTWED_KNA1 AS WED_FREE_SHIP_DAY_FLG,
	YYFRTTHU_KNA1 AS THU_FREE_SHIP_DAY_FLG,
	YYFRTFRI_KNA1 AS FRI_FREE_SHIP_DAY_FLG,
	YYFRTSAT_KNA1 AS SAT_FREE_SHIP_DAY_FLG,
	YYFRTSUN_KNA1 AS SUN_FREE_SHIP_DAY_FLG,
	TATYP_KNVI AS TAX_CTGRY_ID,
	TAXKD_KNVI AS TAX_CLASS_ID,
	VTEXT_TSKDT_TAX_CLASSIFICATION AS TAX_CLASS_DESC_TXT,
	ADRNR_KNA1 AS ADDR_RFRNC_NUM_ID,
	BUILDING_ADRC AS BUILD_ID,
	ROW_ADD_STP AS ROW_ADD_STP,
	ROW_ADD_USER_ID AS ROW_ADD_USER_ID,
	ROW_UPDATE_STP AS ROW_UPDATE_STP,
	ROW_UPDATE_USER_ID AS ROW_UPDATE_USER_ID
FROM `PROJECT_ID.D1_PHM_CONFDIM_CUSTOMER.CUSTOMER_CV`;