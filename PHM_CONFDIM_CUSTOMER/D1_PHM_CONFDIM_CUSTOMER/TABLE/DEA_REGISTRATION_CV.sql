CREATE TABLE `PROJECT_ID.D1_PHM_CONFDIM_CUSTOMER.DEA_REGISTRATION_CV`
(
  DEAREGISTRATIONNUMBER_DEA_REGISTRATION STRING OPTIONS(description="DEA Registration Number"),
  CURR_VRSN_FLG STRING OPTIONS(description="Current Version Flag; default value: 'Y' for Inserts and Update, For Old version records : 'N'"),
  DEL_FLG STRING OPTIONS(description="Delete Flag; default value: 'N'"),
  VRSN_START_DTE DATE OPTIONS(description="Version Start Date; Extracted for file name PARSE_DATE ('%y%m%d',SUBSTR(DEA.D0_SEQ_NUM,-10,6))"),
  VRSN_END_DTE DATE OPTIONS(description="Version End Date; Default : 2099-12-31  For old version recods the Version Start Date of the Current Record"),
  PAYMENTINDICATOR_DEA_REGISTRATION STRING OPTIONS(description="Payment Indicator ID"),
  PAYMENTINDICATORDESC STRING OPTIONS(description="CASE WHEN TRIM(PAYMENTINDICATOR) ='E' THEN 'Exempt' WHEN TRIM(PAYMENTINDICATOR) ='P' THEN 'Paid' ELSE 'NOT_ AVAILABLE'"),
  BUSINESSACTIVITYCODE_DEA_REGISTRATION STRING OPTIONS(description="Business Activity Code"),
  BUSINESSACTIVITYSUBCODE_DEA_REGISTRATION STRING OPTIONS(description="Business Activity Sub Code"),
  BUSINESS_ACTIVITY_DESC_TXT_BUSINESS_ACTIVITY STRING OPTIONS(description="Business Activity Description"),
  EXPIRATIONDATE_DEA_REGISTRATION DATE OPTIONS(description="DEA Registration Expiration Date: PARSE_DATE('%Y%m%d',TRIM(EXPIRATIONDATE))"),
  NAME_DEA_REGISTRATION STRING OPTIONS(description="Company Name"),
  ADDITIONALCOMPANYINFO_DEA_REGISTRATION STRING OPTIONS(description="Additional Company Info"),
  ADDRESS1_DEA_REGISTRATION STRING OPTIONS(description="Address1"),
  ADDRESS2_DEA_REGISTRATION STRING OPTIONS(description="Address2"),
  CITY_DEA_REGISTRATION STRING OPTIONS(description="City"),
  STATE_DEA_REGISTRATION STRING OPTIONS(description="State"),
  CALC_DEA_SCHED_1_FLG STRING OPTIONS(description="Drug Schedule 1 Flag; CASE WHEN SUBSTR(DRUGSCHEDULES,3,1) ='1' THEN 'Y' ELSE 'N'"),
  CALC_DEA_SCHED_2_FLG STRING OPTIONS(description="Drug Schedule 2 Flag; CASE WHEN SUBSTR(DRUGSCHEDULES,4,1) ='2' THEN 'Y' ELSE 'N'"),
  CALC_DEA_SCHED_3_FLG STRING OPTIONS(description="Drug Schedule 3 Flag; CASE WHEN SUBSTR(DRUGSCHEDULES,8,1) ='3' THEN 'Y' ELSE 'N'"),
  CALC_DEA_SCHED_2N_FLG STRING OPTIONS(description="Drug Schedule 2N Flag; CASE WHEN SUBSTR(DRUGSCHEDULES,6,2) ='2N' THEN 'Y' ELSE 'N'"),
  CALC_DEA_SCHED_3N_FLG STRING OPTIONS(description="Drug Schedule 3N Flag; CASE WHEN SUBSTR(DRUGSCHEDULES,10,2) ='3N' THEN 'Y' ELSE 'N'"),
  CALC_DEA_SCHED_4_FLG STRING OPTIONS(description="Drug Schedule 4 Flag; CASE WHEN SUBSTR(DRUGSCHEDULES,12,1) ='4' THEN 'Y' ELSE 'N'"),
  CALC_DEA_SCHED_5_FLG STRING OPTIONS(description="Drug Schedule 5 Flag; CASE WHEN SUBSTR(DRUGSCHEDULES,14,1) ='5' THEN 'Y' ELSE 'N'"),
  CALC_DEA_SCHED_L1_FLG STRING OPTIONS(description="Drug Schedule L1 Flag; CASE WHEN SUBSTR(DRUGSCHEDULES,1,2) ='1' THEN 'Y' ELSE 'N'"),
  ZIP_DEA_REGISTRATION STRING OPTIONS(description="Postal Code"),
  DEGREE_DEA_REGISTRATION STRING OPTIONS(description="Degree"),
  STATELICENSENUMBER_DEA_REGISTRATION STRING OPTIONS(description="State License Number"),
  STATECSLICENSENUMBER_DEA_REGISTRATION STRING OPTIONS(description="State CS License Number"),
  ROW_ADD_STP TIMESTAMP OPTIONS(description="Row Added Timestamp"),
  ROW_ADD_USER_ID STRING OPTIONS(description="Row Added User ID"),
  ROW_UPDATE_STP TIMESTAMP OPTIONS(description="Row Update Timestamp"),
  ROW_UPDATE_USER_ID STRING OPTIONS(description="Row Update User ID")
)
CLUSTER BY DEAREGISTRATIONNUMBER_DEA_REGISTRATION, VRSN_START_DTE, CURR_VRSN_FLG, VRSN_END_DTE;